-- Remover a tabela TB_CLIENTE se ela existir
DROP TABLE IF EXISTS TB_CLIENTE
GO

-- Criar a tabela TB_CLIENTE
CREATE TABLE TB_CLIENTE( ID_CLIENTE INT NOT NULL IDENTITY(1,1),
NM_CLIENTE VARCHAR(200) NOT NULL,
NR_TELEFONE NUMERIC(11) NOT NULL,
NR_CPF NUMERIC(11) NOT NULL,
PRIMARY KEY(ID_CLIENTE))
GO

-- Inserir registros na tabela TB_CLIENTE
INSERT INTO TB_CLIENTE(NM_CLIENTE, NR_TELEFONE, NR_CPF)
VALUES('Vitor', 11911112222, 12312312301)

INSERT INTO TB_CLIENTE(NM_CLIENTE, NR_TELEFONE, NR_CPF)
VALUES('Souza', 11922223333, 45645645602)

INSERT INTO TB_CLIENTE(NM_CLIENTE, NR_TELEFONE, NR_CPF)
VALUES('Maria', 17944445555, 78978978903)

INSERT INTO TB_CLIENTE(NM_CLIENTE, NR_TELEFONE, NR_CPF)
VALUES('Pedro', 15966667777, 14725836904)

-- Selecionar e formatar os dados
SELECT 
	'(' + SUBSTRING(CONVERT(VARCHAR(11), NR_TELEFONE), 1, 2) + ')' + ' ' +
	SUBSTRING(CONVERT(VARCHAR(11), NR_TELEFONE), 3, 5) + '-' +
	SUBSTRING(CONVERT(VARCHAR(11), NR_TELEFONE), 8, 4) AS 'Telefone', 
	SUBSTRING(CONVERT(VARCHAR(11), NR_CPF), 1, 3) + '.' + 
	SUBSTRING(CONVERT(VARCHAR(11), NR_CPF), 4, 3) + '.' + 
	SUBSTRING(CONVERT(VARCHAR(11), NR_CPF), 7, 3)  + '-' +
	SUBSTRING(CONVERT(VARCHAR(11), NR_CPF), 10, 2) AS 'CPF' 
FROM TB_CLIENTE;
